{
  "address": "HBHeroLarYj7jgzWHfmzbwbVG2dUGgzM5CbTP7pJg3K1",
  "metadata": {
    "name": "snake_betting",
    "version": "0.1.0",
    "spec": "0.1.0",
    "description": "Created with Anchor"
  },
  "instructions": [
    {
      "name": "claim_bet_payout",
      "docs": [
        "Apostador do lado vencedor saca sua parte do pool de apostas.",
        "",
        "Aqui só distribuímos o pool de apostas (total_side_a + total_side_b).",
        "Os stakes dos jogadores são tratados na `withdraw_winner_stake`."
      ],
      "discriminator": [
        120,
        6,
        59,
        217,
        73,
        0,
        29,
        129
      ],
      "accounts": [
        {
          "name": "bettor",
          "docs": [
            "Apostador que está sacando"
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "match_account",
          "docs": [
            "Match resolvida"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "match_account.arbiter",
                "account": "Match"
              }
            ]
          }
        },
        {
          "name": "participant",
          "docs": [
            "Conta de participação do apostador"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  112,
                  97,
                  114,
                  116,
                  105,
                  99,
                  105,
                  112,
                  97,
                  110,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "match_account"
              },
              {
                "kind": "account",
                "path": "bettor"
              }
            ]
          }
        }
      ],
      "args": []
    },
    {
      "name": "create_match",
      "docs": [
        "Cria uma nova partida (Match) de aposta da cobrinha.",
        "",
        "- `id`: identificador da partida (pode ser qualquer número, você decide off-chain)",
        "- `stake_lamports`: quanto cada jogador precisa depositar",
        "- `deadline`: timestamp mínimo (Unix) para poder declarar o vencedor",
        "- `player_a`, `player_b`: wallets dos dois jogadores principais"
      ],
      "discriminator": [
        107,
        2,
        184,
        145,
        70,
        142,
        17,
        165
      ],
      "accounts": [
        {
          "name": "arbiter",
          "docs": [
            "Árbitro da partida: quem pode declarar o vencedor"
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "match_account",
          "docs": [
            "Conta principal da partida (Match), criada como PDA"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "arbiter"
              }
            ]
          }
        },
        {
          "name": "system_program",
          "docs": [
            "Programa do sistema (obrigatório pra criar contas)"
          ],
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "id",
          "type": "u64"
        },
        {
          "name": "stake_lamports",
          "type": "u64"
        },
        {
          "name": "deadline",
          "type": "i64"
        },
        {
          "name": "player_a",
          "type": "pubkey"
        },
        {
          "name": "player_b",
          "type": "pubkey"
        }
      ]
    },
    {
      "name": "declare_winner",
      "docs": [
        "Árbitro declara o vencedor (PlayerA ou PlayerB) após o deadline."
      ],
      "discriminator": [
        140,
        135,
        197,
        50,
        9,
        23,
        4,
        80
      ],
      "accounts": [
        {
          "name": "arbiter",
          "docs": [
            "Árbitro que está declarando o resultado"
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "match_account",
          "docs": [
            "Match a ser atualizada"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "match_account.arbiter",
                "account": "Match"
              }
            ]
          }
        }
      ],
      "args": [
        {
          "name": "winner",
          "type": {
            "defined": {
              "name": "Side"
            }
          }
        }
      ]
    },
    {
      "name": "initialize",
      "docs": [
        "Inicialização dummy só pra manter compatibilidade.",
        "Não faz nada por enquanto."
      ],
      "discriminator": [
        175,
        175,
        109,
        31,
        13,
        152,
        155,
        237
      ],
      "accounts": [],
      "args": []
    },
    {
      "name": "join_as_player",
      "docs": [
        "Jogador A ou B deposita o stake na partida.",
        "",
        "- Só aceita `player_a` ou `player_b`.",
        "- Não deixa o mesmo jogador depositar duas vezes.",
        "- Quando os dois depositarem, muda status para `Funded`.",
        "Jogador A ou B deposita o stake na partida.",
        "",
        "- Só aceita `player_a` ou `player_b`.",
        "- Não deixa o mesmo jogador depositar duas vezes.",
        "- Quando os dois depositarem, muda status para `Funded`."
      ],
      "discriminator": [
        129,
        68,
        199,
        75,
        255,
        147,
        154,
        88
      ],
      "accounts": [
        {
          "name": "player",
          "docs": [
            "Jogador A ou B"
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "match_account",
          "docs": [
            "Conta da partida (escrow), que vai receber o SOL"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "match_account.arbiter",
                "account": "Match"
              }
            ]
          }
        },
        {
          "name": "system_program",
          "docs": [
            "Programa do sistema (obrigatório pro transfer)"
          ],
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": []
    },
    {
      "name": "place_bet",
      "docs": [
        "Apostador entra apostando em PlayerA ou PlayerB.",
        "",
        "- `side`: em quem ele está apostando (PlayerA ou PlayerB)",
        "- `amount`: quanto ele está apostando (em lamports)",
        "",
        "A conta `Participant` é criada (se não existir) ou atualizada (se já existir),",
        "e o valor apostado é transferido para a conta Match (escrow)."
      ],
      "discriminator": [
        222,
        62,
        67,
        220,
        63,
        166,
        126,
        33
      ],
      "accounts": [
        {
          "name": "bettor",
          "docs": [
            "Apostador (assinante da transação)"
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "match_account",
          "docs": [
            "Conta da partida (escrow), que vai receber o SOL apostado"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "match_account.arbiter",
                "account": "Match"
              }
            ]
          }
        },
        {
          "name": "participant",
          "docs": [
            "Conta de participação do apostador nessa partida.",
            "Aqui assumimos UMA aposta por bettor por partida."
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  112,
                  97,
                  114,
                  116,
                  105,
                  99,
                  105,
                  112,
                  97,
                  110,
                  116
                ]
              },
              {
                "kind": "account",
                "path": "match_account"
              },
              {
                "kind": "account",
                "path": "bettor"
              }
            ]
          }
        },
        {
          "name": "system_program",
          "docs": [
            "Programa do sistema (para criar conta e transferir SOL)"
          ],
          "address": "11111111111111111111111111111111"
        }
      ],
      "args": [
        {
          "name": "side",
          "type": {
            "defined": {
              "name": "Side"
            }
          }
        },
        {
          "name": "amount",
          "type": "u64"
        }
      ]
    },
    {
      "name": "withdraw_winner_stake",
      "docs": [
        "Jogador vencedor saca os dois stakes (2 x stake_lamports)."
      ],
      "discriminator": [
        81,
        132,
        64,
        239,
        42,
        19,
        155,
        63
      ],
      "accounts": [
        {
          "name": "winner",
          "docs": [
            "Jogador vencedor (PlayerA ou PlayerB)"
          ],
          "writable": true,
          "signer": true
        },
        {
          "name": "match_account",
          "docs": [
            "Match que guarda o escrow"
          ],
          "writable": true,
          "pda": {
            "seeds": [
              {
                "kind": "const",
                "value": [
                  109,
                  97,
                  116,
                  99,
                  104
                ]
              },
              {
                "kind": "account",
                "path": "match_account.arbiter",
                "account": "Match"
              }
            ]
          }
        }
      ],
      "args": []
    }
  ],
  "accounts": [
    {
      "name": "Match",
      "discriminator": [
        236,
        63,
        169,
        38,
        15,
        56,
        196,
        162
      ]
    },
    {
      "name": "Participant",
      "discriminator": [
        32,
        142,
        108,
        79,
        247,
        179,
        54,
        6
      ]
    }
  ],
  "errors": [
    {
      "code": 6000,
      "name": "InvalidDeadline",
      "msg": "Deadline must be in the future"
    },
    {
      "code": 6001,
      "name": "InvalidStake",
      "msg": "Stake must be greater than zero"
    },
    {
      "code": 6002,
      "name": "InvalidStatus",
      "msg": "Match is not in a valid status for this operation"
    },
    {
      "code": 6003,
      "name": "NotAPlayer",
      "msg": "Signer is not a valid player for this match"
    },
    {
      "code": 6004,
      "name": "AlreadyDeposited",
      "msg": "This player has already deposited the stake"
    },
    {
      "code": 6005,
      "name": "InvalidAmount",
      "msg": "Bet amount must be greater than zero"
    },
    {
      "code": 6006,
      "name": "BetsClosed",
      "msg": "Bets are closed for this match"
    },
    {
      "code": 6007,
      "name": "SideMismatch",
      "msg": "Cannot change side after already betting"
    },
    {
      "code": 6008,
      "name": "MathOverflow",
      "msg": "Math overflow"
    },
    {
      "code": 6009,
      "name": "NotArbiter",
      "msg": "Only the arbiter can perform this action"
    },
    {
      "code": 6010,
      "name": "TooEarly",
      "msg": "Too early to declare a winner"
    },
    {
      "code": 6011,
      "name": "AlreadyResolved",
      "msg": "Match already resolved"
    },
    {
      "code": 6012,
      "name": "NoWinner",
      "msg": "Match has no winner yet"
    },
    {
      "code": 6013,
      "name": "NotWinnerPlayer",
      "msg": "Signer is not the winning player"
    },
    {
      "code": 6014,
      "name": "StakesAlreadyWithdrawn",
      "msg": "Stakes have already been withdrawn"
    },
    {
      "code": 6015,
      "name": "NotBettor",
      "msg": "This bettor is not the owner of the participant account"
    },
    {
      "code": 6016,
      "name": "WrongSide",
      "msg": "This participant is on the wrong side (loser side)"
    },
    {
      "code": 6017,
      "name": "AlreadyClaimed",
      "msg": "This participant has already claimed payout"
    },
    {
      "code": 6018,
      "name": "NoBetsOnWinnerSide",
      "msg": "There are no bets on the winner side"
    }
  ],
  "types": [
    {
      "name": "Match",
      "docs": [
        "Conta principal da partida de aposta da cobrinha"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "arbiter",
            "docs": [
              "Árbitro: única conta autorizada a declarar o vencedor"
            ],
            "type": "pubkey"
          },
          {
            "name": "player_a",
            "docs": [
              "Jogadores principais da partida"
            ],
            "type": "pubkey"
          },
          {
            "name": "player_b",
            "type": "pubkey"
          },
          {
            "name": "stake_lamports",
            "docs": [
              "Quanto cada jogador precisa depositar (em lamports)"
            ],
            "type": "u64"
          },
          {
            "name": "total_side_a",
            "docs": [
              "Total de apostas extras em cada lado (torcida)"
            ],
            "type": "u64"
          },
          {
            "name": "total_side_b",
            "type": "u64"
          },
          {
            "name": "deadline",
            "docs": [
              "Timestamp mínimo para poder declarar vencedor"
            ],
            "type": "i64"
          },
          {
            "name": "status",
            "docs": [
              "Status da partida"
            ],
            "type": {
              "defined": {
                "name": "MatchStatus"
              }
            }
          },
          {
            "name": "winner",
            "docs": [
              "Vencedor (Some) quando a partida for resolvida"
            ],
            "type": {
              "option": {
                "defined": {
                  "name": "Side"
                }
              }
            }
          },
          {
            "name": "bump",
            "docs": [
              "Bump do PDA da match"
            ],
            "type": "u8"
          },
          {
            "name": "id",
            "docs": [
              "ID da partida (pode ser incremental ou gerado off-chain)"
            ],
            "type": "u64"
          },
          {
            "name": "player_a_deposited",
            "docs": [
              "Flags indicando se cada player já depositou o stake"
            ],
            "type": "bool"
          },
          {
            "name": "player_b_deposited",
            "type": "bool"
          },
          {
            "name": "stakes_withdrawn",
            "type": "bool"
          }
        ]
      }
    },
    {
      "name": "MatchStatus",
      "docs": [
        "Status da partida (Match) no protocolo"
      ],
      "type": {
        "kind": "enum",
        "variants": [
          {
            "name": "Created"
          },
          {
            "name": "Funded"
          },
          {
            "name": "InProgress"
          },
          {
            "name": "Resolved"
          },
          {
            "name": "Cancelled"
          }
        ]
      }
    },
    {
      "name": "Participant",
      "docs": [
        "Conta de participação/aposta de um usuário em uma Match"
      ],
      "type": {
        "kind": "struct",
        "fields": [
          {
            "name": "match_pubkey",
            "docs": [
              "Referência para a partida"
            ],
            "type": "pubkey"
          },
          {
            "name": "bettor",
            "docs": [
              "Carteira do apostador (bettor)"
            ],
            "type": "pubkey"
          },
          {
            "name": "side",
            "docs": [
              "Lado em que apostou (PlayerA ou PlayerB)"
            ],
            "type": {
              "defined": {
                "name": "Side"
              }
            }
          },
          {
            "name": "amount",
            "docs": [
              "Quantidade apostada em lamports"
            ],
            "type": "u64"
          },
          {
            "name": "claimed",
            "docs": [
              "Já sacou o prêmio/recebeu reembolso?"
            ],
            "type": "bool"
          }
        ]
      }
    },
    {
      "name": "Side",
      "docs": [
        "Lado da aposta: Player A ou Player B"
      ],
      "type": {
        "kind": "enum",
        "variants": [
          {
            "name": "PlayerA"
          },
          {
            "name": "PlayerB"
          }
        ]
      }
    }
  ]
}